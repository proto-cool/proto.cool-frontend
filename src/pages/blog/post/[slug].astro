---
// layout
import BlogPostLayout from "@layouts/BlogPostLayout.astro";

// utils
import { getAllPosts } from "@lib/payload/utils";
import type { Post } from "@lib/payload/payload-types";

// components
import ContentRenderer from "@components/blog/ContentRenderer.astro";

export async function getStaticPaths() {
    const postPages = await getAllPosts();

    const posts = postPages.map((page) => page.docs).flat();

    return posts.map((post) => ({
        params: { slug: post.slug },
        props: post,
    }));
}

const post = Astro.props as Post;
---

<BlogPostLayout post={post}>
    <ContentRenderer node={post.content.root} />
</BlogPostLayout>
